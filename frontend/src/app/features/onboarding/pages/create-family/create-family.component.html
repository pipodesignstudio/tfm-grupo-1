<div class="create-family-container">
  <div class="create-family-content card">
    <h1 class="page-title">Perfil del Niño</h1>

    <!-- OPCIONAL: Añadir foto de perfil niño -->
    <!-- <div class="profile-picture-section">
      <input
        type="file"
        #fileInput
        (change)="onFileSelected($event)"
        accept="image/*"
        class="file-input"
      />
      <div class="profile-picture-placeholder" (click)="fileInput.click()">
        @if (profileImageUrl) {
        <img
          [src]="profileImageUrl"
          alt="Foto de Perfil del Niño"
          class="profile-image"
        />
        } @else {
        <img
          src="https://img.icons8.com/?size=40&id=85103&format=png&color=000000"
          alt="Cargar foto"
          class="camera-png-icon"
        />
        }
      </div>
      <p class="profile-tip"></p>
    </div> -->

    <form
      [formGroup]="childProfileForm"
      (ngSubmit)="onSubmit()"
      class="child-profile-form"
    >
      <div class="input-group p-fluid">
        <label for="name"
          >Nombre <span class="required-asterisk">*</span></label
        >
        <input
          type="text"
          id="name"
          pInputText
          formControlName="name"
          placeholder="Nombre del niño/a"
          [ngClass]="{
            'ng-invalid ng-dirty': f['name'].invalid && f['name'].touched
          }"
        />
        @if (f['name'].invalid && f['name'].dirty) {
        <small class="p-error">
          @if (f['name'].errors?.['required']) { El nombre es obligatorio. }
        </small>
        }
      </div>

      <div class="input-group p-fluid">
        <label for="dob"
          >Fecha de Nacimiento <span class="required-asterisk">*</span></label
        >
        <p-calendar
          inputId="dob"
          formControlName="dob"
          [maxDate]="maxDate"
          [readonlyInput]="true"
          dateFormat="dd-mm-yy"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [ngClass]="{
            'ng-invalid ng-dirty': f['dob'].invalid && f['dob'].touched
          }"
        ></p-calendar>
        @if (f['dob'].invalid && f['dob'].dirty) {
        <small class="p-error">
          @if (f['dob'].errors?.['required']) { La fecha de nacimiento es
          obligatoria. }
        </small>
        }
      </div>

      <div class="input-group p-fluid">
        <label for="gender">Género (Opcional)</label>
        <p-dropdown
          inputId="gender"
          formControlName="gender"
          [options]="genderOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Selecciona el género"
          [showClear]="true"
        ></p-dropdown>
      </div>

      <div class="input-group p-fluid">
        <label for="heightCm">Altura (cm - Opcional)</label>
        <input
          type="number"
          id="heightCm"
          pInputText
          formControlName="heightCm"
          placeholder="Ej: 90"
          [ngClass]="{
            'ng-invalid ng-dirty':
              f['heightCm'].invalid && f['heightCm'].touched
          }"
        />
        @if (f['heightCm'].invalid && f['heightCm'].dirty) {
        <small class="p-error">
          @if (f['heightCm'].errors?.['min'] || f['heightCm'].errors?.['max']) {
          Introduce una altura válida (1-300 cm). }
        </small>
        }
      </div>

      <div class="input-group p-fluid">
        <label for="weightKg">Peso (kg - Opcional)</label>
        <input
          type="number"
          step="0.1"
          id="weightKg"
          pInputText
          formControlName="weightKg"
          placeholder="Ej: 15.5"
          [ngClass]="{
            'ng-invalid ng-dirty':
              f['weightKg'].invalid && f['weightKg'].touched
          }"
        />
        @if (f['weightKg'].invalid && f['weightKg'].dirty) {
        <small class="p-error">
          @if (f['weightKg'].errors?.['min'] || f['weightKg'].errors?.['max']) {
          Introduce un peso válido (0.1-200 kg). }
        </small>
        }
      </div>

      @if (errorMessage) {
      <small class="p-error">{{ errorMessage }}</small>
      }

      <button
        pButton
        type="submit"
        label="Enviar"
        class="p-button-primary"
      ></button>
    </form>
  </div>
</div>
